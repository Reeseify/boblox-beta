<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Boblox - Game</title>
  <link rel="stylesheet" href="../game-style.css"> <!-- Use your game-specific CSS -->
  <link rel="icon" href="https://beta.boblox.ca/favicon.png">
</head>

<body>
  <!-- Top Bar -->
  <div class="top-bar">
    <img src="../boblox-logo.png" alt="Boblox Logo" class="logo">
    <div class="nav-buttons">
      <button onclick="window.location.href='/home.html'">Home</button>
      <button>Games</button>
      <button>Catalog</button>
      <button>Create</button>
      <button>Profile</button>
    </div>
    <input type="text" placeholder="Search">
  </div>

  <!-- Sidebar (Shown only if logged in) -->
  <div id="sidebar" class="sidebar" style="display:none;">
    <nav>
      <a href="#">Home</a>
      <a href="#">Profile</a>
      <a href="#">Messages</a>
      <a href="#">Friends</a>
      <a href="#">Avatar</a>
      <a href="#">Shop</a>
      <a href="#">Create</a>
      <a href="#">Robux</a>
    </nav>
  </div>

  <!-- Game Content -->
  <div class="main-content">
    <div id="game-container">
      <h1>Loading Game...</h1>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <img src="../boblox-logo.png" alt="Boblox Logo">
    <span>Copyright Boblox 2025</span>
  </footer>

  <script>
    // Check login cookie
    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      return parts.length === 2 ? parts.pop().split(';').shift() : null;
    }

    // Show sidebar if logged in
    if (getCookie('bobloxUser')) {
      document.getElementById('sidebar').style.display = 'flex';
    }

    const container = document.getElementById('game-container');

    // Get the game ID from URL ?id=1
    const params = new URLSearchParams(window.location.search);
    const gameId = params.get('id');

    if (!gameId || isNaN(gameId)) {
      container.innerHTML = '<h2>Invalid Game ID</h2>';
    } else {
      // Fetch game data from your server (replace URL with your API endpoint)
      fetch(`https://3fsvj1zh-3000.use.devtunnels.ms/assets/get?assetId=${gameId}`)
        .then(response => {
          if (!response.ok) throw new Error('Failed to fetch game');
          return response.json();
        })
        .then(game => {
          container.innerHTML = `
            <div class="game-header">
              <img src="${game.thumbnail}" alt="Game Thumbnail" class="game-thumbnail">
              <div class="game-details">
                <h1>${game.name}</h1>
                <p>${game.description}</p>
                <button class="play-button">Play</button>
              </div>
            </div>
            <div class="stats">
              <div>Visits: ${game.visits || 0}</div>
              <div>Likes: ${game.likes || 0}%</div>
              <div>Created: ${game.created || 'Unknown'}</div>
              <div>Updated: ${game.updated || 'Unknown'}</div>
            </div>
          `;
        })
        .catch(() => {
          container.innerHTML = `
            <div style="text-align:center; margin-top: 100px; font-size: 20px; color: #ccc;">
              Problem communicating with servers
            </div>
          `;
        });
    }
  </script>

</body>
</html>
